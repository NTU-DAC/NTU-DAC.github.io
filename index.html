<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>NTU DAC Online Judge</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/pyodide/v0.24.1/full/pyodide.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        :root {
            --primary-color: #1E4A73;
            --secondary-color: #1E4A73;
            --success-color: #4caf50;
            --error-color: #f44336;
            --warning-color: #ff9800;
            --dark-bg: #1a1a2e;
            --light-bg: #f8f9fa;
        }

        body {
            font-family: 'Segoe UI', -apple-system, BlinkMacSystemFont, 'Roboto', sans-serif;
            background: linear-gradient(135deg, var(--primary-color) 0%, var(--secondary-color) 100%);
            min-height: 100vh;
            padding: 0;
            margin: 0;
            background-attachment: fixed;
        }

        /* Navigation Bar */
        .navbar {
            background: #EFEAE6;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            position: sticky;
            top: 0;
            z-index: 1000;
            backdrop-filter: blur(10px);
        }

        .nav-container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            height: 70px;
        }

        .nav-brand {
            font-size: 1.5em;
            font-weight: bold;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .nav-logo-img {
            width: 60px;    
            height: 60px;   
            object-fit: contain;  
        }
        
        .nav-logo-fallback {
            width: 30px;
            height: 30px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            font-size: 1em;  
        }

        .nav-menu {
            display: flex;
            list-style: none;
            gap: 30px;
        }

        .nav-item {
            position: relative;
        }

        .nav-link {
            text-decoration: none;
            color: #333;
            font-weight: 500;
            padding: 10px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .nav-link:hover {
            background: rgba(102, 126, 234, 0.1);
            color: var(--primary-color);
        }

        .nav-link.active {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        /* Page Container */
        .page {
            display: none;
            min-height: calc(100vh - 70px);
            padding: 40px 20px;
            animation: fadeIn 0.5s ease;
        }

        .page.active {
            display: block;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            padding: 40px;
        }

        /* Home */
        .hero-section {
            text-align: center;
            padding: 60px 20px;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.1), rgba(118, 75, 162, 0.1));
            border-radius: 20px;
            margin-bottom: 40px;
        }

        .hero-title {
            font-size: 3em;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            animation: fadeInDown 0.8s ease;
        }

        .hero-subtitle {
            font-size: 1.3em;
            color: #666;
            margin-bottom: 30px;
            animation: fadeInUp 0.8s ease;
        }

        .feature-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 30px;
            margin-top: 40px;
        }

        .feature-card {
            background: white;
            padding: 30px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border-top: 4px solid var(--primary-color);
        }

        .feature-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.15);
        }

        .feature-icon {
            font-size: 2.5em;
            margin-bottom: 15px;
            color: var(--primary-color);
        }

        .feature-title {
            font-size: 1.3em;
            color: #333;
            margin-bottom: 10px;
        }

        .feature-description {
            color: #666;
            line-height: 1.6;
        }

        /* Course Page */
        .timeline {
            position: relative;
            padding: 20px 0;
        }

        .timeline::before {
            content: '';
            position: absolute;
            left: 50px;
            top: 0;
            bottom: 0;
            width: 3px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }

        .week-section {
            position: relative;
            margin-bottom: 50px;
            padding-left: 80px;
        }

        .week-marker {
            position: absolute;
            left: 35px;
            top: 0;
            width: 30px;
            height: 30px;
            background: white;
            border: 4px solid var(--primary-color);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: var(--primary-color);
        }

        .week-content {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
        }

        .week-title {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .unit-list {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }

        .unit-item {
            background: var(--light-bg);
            padding: 20px;
            border-radius: 10px;
            border-left: 4px solid var(--primary-color);
        }

        .unit-title {
            font-weight: 600;
            color: #333;
            margin-bottom: 15px;
            font-size: 1.1em;
        }

        .unit-links {
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
        }

        .unit-link {
            display: inline-flex;
            align-items: center;
            gap: 5px;
            padding: 8px 15px;
            background: white;
            border: 2px solid var(--primary-color);
            color: var(--primary-color);
            text-decoration: none;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
        }

        .unit-link:hover {
            background: var(--primary-color);
            color: white;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        /* Problem List Page */
        .category-tabs {
            display: flex;
            gap: 20px;
            margin-bottom: 30px;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }

        .category-tab {
            padding: 10px 20px;
            background: transparent;
            border: none;
            font-size: 1.1em;
            font-weight: 600;
            color: #666;
            cursor: pointer;
            position: relative;
            transition: all 0.3s ease;
        }

        .category-tab.active {
            color: var(--primary-color);
        }

        .category-tab.active::after {
            content: '';
            position: absolute;
            bottom: -12px;
            left: 0;
            right: 0;
            height: 3px;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
        }

        .problem-list {
            display: grid;
            gap: 20px;
        }

        .problem-card {
            background: white;
            padding: 20px;
            border-radius: 12px;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            border-left: 4px solid var(--primary-color);
        }

        .problem-card:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
        }

        .problem-title {
            font-size: 1.2em;
            font-weight: 600;
            color: #333;
            margin-bottom: 10px;
        }

        .problem-difficulty {
            display: inline-block;
            padding: 5px 12px;
            border-radius: 20px;
            font-size: 0.85em;
            font-weight: 500;
            margin-right: 10px;
        }

        .difficulty-easy {
            background: #e8f5e9;
            color: #2e7d32;
        }

        .difficulty-medium {
            background: #fff3e0;
            color: #ef6c00;
        }

        .difficulty-hard {
            background: #ffebee;
            color: #c62828;
        }

        .problem-tags {
            display: flex;
            gap: 8px;
            margin-top: 10px;
            flex-wrap: wrap;
        }

        .problem-tag {
            padding: 3px 10px;
            background: #e3f2fd;
            color: #1565c0;
            border-radius: 12px;
            font-size: 0.85em;
        }

        /* Code Editor */
        .code-editor-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.7);
            z-index: 2000;
            animation: fadeIn 0.3s ease;
        }

        .code-editor-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .editor-container {
            background: white;
            width: 90%;
            max-width: 1000px;
            height: 90vh;
            border-radius: 20px;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
        }

        .editor-header {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            padding: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .editor-title {
            font-size: 1.3em;
            font-weight: 600;
        }

        .close-editor {
            background: rgba(255, 255, 255, 0.2);
            border: none;
            color: white;
            padding: 8px 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1em;
            transition: all 0.3s ease;
        }

        .close-editor:hover {
            background: rgba(255, 255, 255, 0.3);
        }

        .editor-body {
            flex: 1;
            display: flex;
            flex-direction: column;
            padding: 20px;
            overflow-y: auto;
        }

        .problem-description {
            background: var(--light-bg);
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            border-left: 4px solid var(--primary-color);
        }

        .test-cases {
            background: #f0f4ff;
            padding: 15px;
            border-radius: 8px;
            margin-top: 10px;
            font-family: 'Courier New', monospace;
        }

        #code-editor {
            width: 100%;
            min-height: 300px;
            padding: 15px;
            border: 2px solid #e0e0e0;
            border-radius: 10px;
            font-family: 'Courier New', Courier, monospace;
            font-size: 14px;
            background: var(--light-bg);
            resize: vertical;
            transition: all 0.3s ease;
        }

        #code-editor:focus {
            outline: none;
            border-color: var(--primary-color);
            background: white;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .editor-controls {
            display: flex;
            gap: 15px;
            margin-top: 20px;
        }

        .btn {
            flex: 1;
            padding: 12px 24px;
            border: none;
            border-radius: 10px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .btn-run {
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
        }

        .btn-run:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .btn-submit {
            background: linear-gradient(135deg, #f093fb, #f5576c);
            color: white;
        }

        .btn-submit:hover:not(:disabled) {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(245, 87, 108, 0.3);
        }

        .btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        .output-section {
            background: var(--dark-bg);
            border-radius: 10px;
            padding: 20px;
            color: #f0f0f0;
            min-height: 150px;
            font-family: 'Courier New', monospace;
            margin-top: 20px;
            white-space: pre-wrap;
            line-height: 1.6;
            overflow-x: auto;
        }

        .success {
            color: var(--success-color);
            font-weight: bold;
        }

        .error {
            color: var(--error-color);
            font-weight: bold;
        }

        .warning {
            color: var(--warning-color);
            font-weight: bold;
        }

        /* About Page */
        .about-content {
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.8;
            color: #333;
        }

        .about-section {
            margin-bottom: 40px;
        }

        .about-title {
            font-size: 2em;
            color: var(--primary-color);
            margin-bottom: 20px;
            text-align: center;
        }

        .about-subtitle {
            font-size: 1.5em;
            color: #333;
            margin-bottom: 15px;
            margin-top: 30px;
            border-bottom: 2px solid var(--primary-color);
            padding-bottom: 10px;
        }

        .about-text {
            font-size: 1.1em;
            color: #666;
            margin-bottom: 15px;
        }

        .contact-info {
            background: var(--light-bg);
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
        }

        /* User Information */
        .student-info-bar {
            background: rgba(255, 255, 255, 0.98);
            padding: 15px;
            position: fixed;
            bottom: 20px;
            right: 20px;
            border-radius: 15px;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
            z-index: 999;
            display: flex;
            align-items: center;
            gap: 15px;
        }

        .student-info-bar input {
            padding: 8px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            font-size: 14px;
            width: 200px;
        }

        .student-info-bar input:focus {
            outline: none;
            border-color: var(--primary-color);
        }

        .student-info-label {
            font-weight: 600;
            color: #333;
        }

        @media (max-width: 768px) {
            .nav-menu {
                flex-direction: column;
                position: absolute;
                top: 70px;
                left: 0;
                right: 0;
                background: white;
                padding: 20px;
                box-shadow: 0 5px 15px rgba(0, 0, 0, 0.1);
                display: none;
            }

            .nav-menu.active {
                display: flex;
            }

            .hero-title {
                font-size: 2em;
            }

            .timeline::before {
                left: 20px;
            }

            .week-section {
                padding-left: 50px;
            }

            .week-marker {
                left: 5px;
            }

            .editor-container {
                width: 100%;
                height: 100vh;
                border-radius: 0;
            }
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
            }
            to {
                opacity: 1;
            }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .progress-bar {
            width: 100%;
            height: 4px;
            background: #e0e0e0;
            border-radius: 2px;
            overflow: hidden;
            margin: 10px 0;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--primary-color), var(--secondary-color));
            width: 0%;
            transition: width 0.3s ease;
        }

        /* Pyodide State Indicator */
        .pyodide-status {
            position: fixed;
            bottom: 20px;
            left: 20px;
            padding: 10px 20px;
            border-radius: 20px;
            background: white;
            box-shadow: 0 3px 10px rgba(0, 0, 0, 0.1);
            font-size: 0.9em;
            font-weight: 500;
            z-index: 999;
        }

        .status-loading {
            background: var(--warning-color);
            color: white;
        }

        .status-ready {
            background: var(--success-color);
            color: white;
        }
    </style>
</head>
<body>
    <!-- Navigation Bar -->
    <nav class="navbar">
        <div class="nav-container">
            <a href="#" class="nav-brand" onclick="showPage(event, 'home')">
                <img src="assets/logo.png" alt="Python Logo" class="nav-logo-img" onerror="this.style.display='none'; document.getElementById('logo-fallback').style.display='flex';">
                <div id="logo-fallback" class="nav-logo-fallback" style="display:none;">Py</div>
                NTU DAC Online Judge
            </a>
            <ul class="nav-menu">
                <li class="nav-item">
                    <a class="nav-link active" onclick="showPage(event, 'home')">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage(event, 'courses')">Course</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage(event, 'problems')">Problem</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" onclick="showPage(event, 'about')">About</a>
                </li>
            </ul>
        </div>
    </nav>

    <!-- Home -->
    <div id="home-page" class="page active">
        <div class="container">
            <div class="hero-section">
                <h1 class="hero-title">Welcome to NTU DAC Online Judge</h1>
                <p class="hero-subtitle">Beginner to Pro: Learn Python Step by Step</p>
            </div>
            <div class="feature-grid">
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-book"></i></div>
                    <h3 class="feature-title">Structured Courses</h3>
                    <p class="feature-description">A complete 5-week program, from basics to advanced, with weekly video lessons and hands-on exercises.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-keyboard"></i></div>
                    <h3 class="feature-title">Online Code Editor</h3>
                    <p class="feature-description">Built-in editor, no installation required. Write and run Python code directly in your browser.</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon"><i class="fas fa-bolt"></i></div>
                    <h3 class="feature-title">Instant Testing System</h3>
                    <p class="feature-description">Automatic judging with real-time feedback, including both public and hidden test cases.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Course Page-->
    <div id="courses-page" class="page">
        <div class="container">
            <h1 style="text-align: center; margin-bottom: 40px; color: #333;">Course Timeline</h1>
            
            <div class="timeline">
                <!-- 1th Week -->
                <div class="week-section">
                    <div class="week-marker">1</div>
                    <div class="week-content">
                        <h2 class="week-title">
                            <span>Week 1: Introduction to Python</span>
                        </h2>
                        <div class="unit-list">
                            <div class="unit-item">
                                <div class="unit-title">1.1 Basic I/O</div>
                                <div class="unit-links">
                                    <a href="https://youtu.be/uX6qIg9v7V8?si=L2OcyZsZ0AJXOYd4" target="_blank" class="unit-link">
                                        ‚ñ∂Ô∏è YouTube Link
                                    </a>
                                    <a href="https://colab.research.google.com/drive/19TLluPH2jk2KqiiNSiwr1MjlBLOnBX7D?usp=sharing" target="_blank" class="unit-link">
                                        üìì Colab Link
                                    </a>
                                </div>
                            </div>
                            <div class="unit-item">
                                <div class="unit-title">1.2 Variables Concept</div>
                                <div class="unit-links">
                                    <a href="https://youtu.be/uBRiDTXhkWE?si=CeCp3oyYmhj38soC" target="_blank" class="unit-link">
                                        ‚ñ∂Ô∏è YouTube Link
                                    </a>
                                    <a href="https://colab.research.google.com/drive/19TLluPH2jk2KqiiNSiwr1MjlBLOnBX7D?usp=sharing" target="_blank" class="unit-link">
                                        üìì Colab Link
                                    </a>
                                </div>
                            </div>
                            <div class="unit-item">
                                <div class="unit-title">1.3 Numbers</div>
                                <div class="unit-links">
                                    <a href="https://youtu.be/dVqpyBag7Vo?si=wAtYurvbjBrRl3CS" target="_blank" class="unit-link">
                                        ‚ñ∂Ô∏è YouTube Link
                                    </a>
                                    <a href="https://colab.research.google.com/drive/19TLluPH2jk2KqiiNSiwr1MjlBLOnBX7D?usp=sharing" target="_blank" class="unit-link">
                                        üìì Colab Link
                                    </a>
                                </div>
                            </div>
                            <div class="unit-item">
                                <div class="unit-title">1.4 Strings</div>
                                <div class="unit-links">
                                    <a href="https://youtu.be/oIoXwy9L5Kc?si=zWMsDl34_VYX83O7" target="_blank" class="unit-link">
                                        ‚ñ∂Ô∏è YouTube Link
                                    </a>
                                    <a href="https://colab.research.google.com/drive/1WpaVDblU0ep-gUBZdeoWXCzp9MiU11PF?usp=sharing" target="_blank" class="unit-link">
                                        üìì Colab Link
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 2th Week -->
                <div class="week-section">
                    <div class="week-marker">2</div>
                    <div class="week-content">
                        <h2 class="week-title">
                            <span>Week 2: Basic Control Flow</span>
                        </h2>
                        <div class="unit-list">
                            <div class="unit-item">
                                <div class="unit-title">2.1 Conditionals: if-elif-else</div>
                                <div class="unit-links">
                                    <a href="https://youtu.be/g1KFaO5Euq8?si=sz3241ruRRMdlED1" target="_blank" class="unit-link">
                                        ‚ñ∂Ô∏è YouTube Link
                                    </a>
                                    <a href="https://colab.research.google.com/drive/1Jw-smtV9w5GDyhXKlGF0XeWcLqxWej-e?usp=sharing" target="_blank" class="unit-link">
                                        üìì Colab Link
                                    </a>
                                </div>
                            </div>
                            <div class="unit-item">
                                <div class="unit-title">2.2 Loops: while and for</div>
                                <div class="unit-links">
                                    <a href="https://youtu.be/hjk2Pswfym0?si=VgskPwnh74jXfd09" target="_blank" class="unit-link">
                                        ‚ñ∂Ô∏è YouTube Link
                                    </a>
                                    <a href="https://colab.research.google.com/drive/1Jw-smtV9w5GDyhXKlGF0XeWcLqxWej-e?usp=sharing" target="_blank" class="unit-link">
                                        üìì Colab Link
                                    </a>
                                </div>
                            </div>
                            <div class="unit-item">
                                <div class="unit-title">2.3 Lists</div>
                                <div class="unit-links">
                                    <a href="https://youtu.be/E-ge0mO2jtk?si=cofsESVYVauktMwV" target="_blank" class="unit-link">
                                        ‚ñ∂Ô∏è YouTube Link
                                    </a>
                                    <a href="https://drive.google.com/open?id=1bVmBuuyoSZSf3wQavx1izyyAQOS2SV49&usp=drive_copy" target="_blank" class="unit-link">
                                        üìì Colab Link
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3th Week -->
                <div class="week-section">
                    <div class="week-marker">3</div>
                    <div class="week-content">
                        <h2 class="week-title">
                            <span>Week 3: Advanced Data Structures</span>
                        </h2>
                        <div class="unit-list">
                            <div class="unit-item">
                                <div class="unit-title">3.1 Tuple/Set/Dictionary</div>
                                <div class="unit-links">
                                    <a href="https://youtu.be/HVgnP3-N5Ig?si=tbURhEwTFNUoYV_x" target="_blank" class="unit-link">
                                        ‚ñ∂Ô∏è YouTube Link
                                    </a>
                                    <a href="https://drive.google.com/open?id=1ubny_Go6BvyaCmB5eq1SHTo_4kIZcaBs&usp=drive_copy" target="_blank" class="unit-link">
                                        üìì Colab Link
                                    </a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

            </div>
        </div>
    </div>

    <!-- Problem List Page -->
    <div id="problems-page" class="page">
        <div class="container">
            <h1 style="text-align: center; margin-bottom: 40px; color: #333;">Problem Set</h1>
            
            <div class="category-tabs">
                <button class="category-tab active" onclick="showCategory(event, 'arena')">Course Assignments</button>
                <button class="category-tab" onclick="showCategory(event, 'competition')">Competition Problems</button>
                <button class="category-tab" onclick="showCategory(event, 'uncategorized')">Uncategorized Problems</button>
            </div>

            <!-- Course Assignments -->
            <div id="arena-problems" class="problem-list">
                <div class="problem-card" onclick="openProblem('arena1')">
                    <h3 class="problem-title">A1: Print Hello World</h3>
                    <span class="problem-difficulty difficulty-easy">Easy</span>
                </div>
                <div class="problem-card" onclick="openProblem('arena2')">
                    <h3 class="problem-title">A2: Sum of Numbers</h3>
                    <span class="problem-difficulty difficulty-easy">Easy</span>
                </div>
            </div>

            <!-- Competition Problems -->
            <div id="competition-problems" class="problem-list" style="display: none;">
                <div class="problem-card" onclick="openProblem('comp1')">
                    <h3 class="problem-title">C1: Prime Number Check</h3>
                    <span class="problem-difficulty difficulty-medium">Medium</span>
                </div>
                <div class="problem-card" onclick="openProblem('comp2')">
                    <h3 class="problem-title">C2: Reverse String</h3>
                    <span class="problem-difficulty difficulty-medium">Medium</span>
                </div>
            </div>

            <!-- Uncategorized Problems -->
            <div id="uncategorized-problems" class="problem-list" style="display: none;">
                <div class="problem-card" onclick="openProblem('misc1')">
                    <h3 class="problem-title">M1: Palindrome Check</h3>
                    <span class="problem-difficulty difficulty-hard">Hard</span>
                </div>
                <div class="problem-card" onclick="openProblem('misc2')">
                    <h3 class="problem-title">M2: Factorial Calculation</h3>
                    <span class="problem-difficulty difficulty-hard">Hard</span>
                </div>
            </div>
        </div>
    </div>

    <!-- About Page -->
    <div id="about-page" class="page">
        <div class="container">
            <div class="about-content">
                <h1 class="about-title">About Us</h1>
                
                <div class="about-section">
                    <p class="about-text">
                        This is the Python practice platform of NTU DAC (National Taiwan University Data Analytics Club).  
                        Contributors include:  
                        <br><br>
                        Website Author:  
                        <br>&nbsp;&nbsp;Hubert Huang (NTU BA)  
                        <br><br>
                        Course and Assignment Authors:  
                        <br>&nbsp;&nbsp;Benson Chiu (NTU IM)  
                        <br>&nbsp;&nbsp;Hugh Yib (NTU IB)
                        <br>&nbsp;&nbsp;Hubert Huang (NTU BA)
                        <br>&nbsp;&nbsp;Sabina Lu (NTU ACCT)
                        <br>&nbsp;&nbsp;Rita Sheng (NTU STAT)  
                        <br><br>
                        If you would like to use the resources of this website, please contact  
                        <a href="mailto:ntu.data.analytics@gmail.com">ntu.data.analytics@gmail.com</a>  
                        and indicate the source. 
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Code Editor Modal Window -->
    <div id="code-editor-modal" class="code-editor-modal">
        <div class="editor-container">
            <div class="editor-header">
                <span class="editor-title" id="editor-title">Problem Title</span>
                <button class="close-editor" onclick="closeEditor()">‚úï Close</button>
            </div>
            <div class="editor-body">
                <div class="problem-description">
                    <h3>Problem Description</h3>
                    <p id="problem-text"></p>
                    <div class="test-cases" id="test-cases"></div>
                </div>
                
                <label for="code-editor" style="font-weight: 600; margin-bottom: 10px; display: block;">
                    Code Editor Area:
                </label>
                <textarea id="code-editor" placeholder="Enter your Python code here..."></textarea>
                
                <div class="editor-controls">
                    <button class="btn btn-run" id="run-btn" onclick="runCode()">
                        Run
                    </button>
                    <button class="btn btn-submit" id="submit-btn" onclick="submitCode()">
                        Submit
                    </button>
                </div>

                <div class="progress-bar" id="progress-bar" style="display: none;">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>

                <div class="output-section" id="output">
                    Waiting for Execution...
                </div>
            </div>
        </div>
    </div>

    <!-- User Information -->
    <div class="student-info-bar">
        <span class="student-info-label">User Name:</span>
        <input type="text" id="student-name" placeholder="Enter your name">
    </div>

    <!-- Pyodide State Indicator -->
    <div id="pyodide-status" class="pyodide-status status-loading">
        Loading Python Environment...
    </div>

    <script>
        // Problem Database
        const problems = {
            // Course Assignments
            arena1: {
                id: 'arena1',
                title: "A1: Print Hello World",
                description: "Write a program that outputs the string 'Hello, World!'.",
                publicTestCases: [
                    { input: "", expected: "Hello, World!" }
                ],
                hiddenTestCases: [],
                template: "",
                hasHiddenTests: false
            },
            arena2: {
                id: 'arena2',
                title: "A2: Sum of Numbers",
                description: "Write a program that reads two integers and outputs their sum.",
                publicTestCases: [
                    { input: "3\n5", expected: "8" },
                    { input: "10\n20", expected: "30" }
                ],
                hiddenTestCases: [
                    { input: "-5\n5", expected: "0" },
                    { input: "999999\n1", expected: "1000000" },
                    { input: "-100\n-200", expected: "-300" }
                ],
                template: "",
                hasHiddenTests: true
            },
            // Competition Problems
            comp1: {
                id: 'comp1',
                title: "C1: Prime Number Check",
                description: "Write a program that reads a positive integer and determines whether it is a prime number. If it is prime, output 'Prime'; otherwise, output 'Not Prime'",
                publicTestCases: [
                    { input: "2", expected: "Prime" },
                    { input: "4", expected: "Not Prime" },
                    { input: "17", expected: "Prime" }
                ],
                hiddenTestCases: [
                    { input: "1", expected: "Not Prime" },
                    { input: "97", expected: "Prime" },
                    { input: "100", expected: "Not Prime" }
                ],
                template: "",
                hasHiddenTests: true
            },
            comp2: {
                id: 'comp2',
                title: "C2: Reverse String",
                description: "Write a program that reads a string and outputs the reversed string.",
                publicTestCases: [
                    { input: "hello", expected: "olleh" },
                    { input: "Python", expected: "nohtyP" }
                ],
                hiddenTestCases: [
                    { input: "12345", expected: "54321" },
                    { input: "a", expected: "a" }
                ],
                template: "",
                hasHiddenTests: true
            },
            // Uncategorized Problems
            misc1: {
                id: 'misc1',
                title: "M1: Palindrome Check",
                description: "Write a program that reads a string and determines whether it is a palindrome (the same when read forwards and backwards). If it is, output 'Yes'; otherwise, output 'No'.",
                publicTestCases: [
                    { input: "level", expected: "Yes" },
                    { input: "hello", expected: "No" }
                ],
                hiddenTestCases: [
                    { input: "racecar", expected: "Yes" },
                    { input: "12321", expected: "Yes" }
                ],
                template: "",
                hasHiddenTests: true
            },
            misc2: {
                id: 'misc2',
                title: "M2: Factorial Calculation",
                description: "Write a program that reads a non-negative integer n and outputs the factorial of n.",
                publicTestCases: [
                    { input: "5", expected: "120" },
                    { input: "0", expected: "1" }
                ],
                hiddenTestCases: [
                    { input: "10", expected: "3628800" },
                    { input: "1", expected: "1" }
                ],
                template: "",
                hasHiddenTests: true
            }
        };

        // Google Form Settings
        const GOOGLE_FORM_ACTION = 'https://docs.google.com/forms/u/0/d/e/1FAIpQLSfyrzuKPxOqT9dn2FBSWGXJ7kw8y3KD57j1F35wPaSoOA1O-w/formResponse';
        const ENTRY_NAME = 'entry.498172862';
        const ENTRY_PROBLEM = 'entry.2067718239';
        const ENTRY_CODE = 'entry.1618746730';
        const ENTRY_RESULT = 'entry.58630826';
        const ENTRY_ACCURACY = 'entry.574605597';

        // Global Variables
        let pyodide;
        let currentProblem = null;
        let testPassed = false;
        let isRunning = false;
        let testAccuracy = 0;
        const TIMEOUT_LIMIT = 10000;

        // Page Switch
        function showPage(event, pageName) {
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            document.getElementById(`${pageName}-page`).classList.add('active');
            
            document.querySelectorAll('.nav-link').forEach(link => {
                link.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        // Problem Category Switch
        function showCategory(event, category) {
            document.querySelectorAll('.category-tab').forEach(tab => {
                tab.classList.remove('active');
            });
            event.target.classList.add('active');
            
            document.getElementById('arena-problems').style.display = category === 'arena' ? 'grid' : 'none';
            document.getElementById('competition-problems').style.display = category === 'competition' ? 'grid' : 'none';
            document.getElementById('uncategorized-problems').style.display = category === 'uncategorized' ? 'grid' : 'none';
        }

        // Open Problem
        function openProblem(problemId) {
            const problem = problems[problemId];
            if (!problem) {
                alert('Problem does not exist!');
                return;
            }
            
            currentProblem = problem;
            
            document.getElementById('editor-title').textContent = problem.title;
            document.getElementById('problem-text').textContent = problem.description;
            
            let testCasesHtml = '<strong>Public Test Cases:</strong><br>';
            problem.publicTestCases.forEach((tc, index) => {
                testCasesHtml += `<div style="margin: 10px 0;">`;
                testCasesHtml += `Test Case ${index + 1}:<br>`;
                if (tc.input) {
                    testCasesHtml += `Input: <code>${tc.input.replace(/\n/g, ', ')}</code><br>`;
                } else {
                    testCasesHtml += `Input: (no input)<br>`;
                }
                testCasesHtml += `Expected Output: <code>${tc.expected}</code><br>`;
                testCasesHtml += `</div>`;
            });
            
            if (problem.hasHiddenTests) {
                testCasesHtml += '<br><em style="color: #ff9800;">This problem contains hidden test cases</em>';
            }
            
            document.getElementById('test-cases').innerHTML = testCasesHtml;
            document.getElementById('code-editor').value = problem.template;
            document.getElementById('output').textContent = 'Waiting for execution...';
            document.getElementById('code-editor-modal').classList.add('active');
            
            testPassed = false;
            testAccuracy = 0;
            updateSubmitButton();
        }

        // Close Editor
        function closeEditor() {
            document.getElementById('code-editor-modal').classList.remove('active');
            currentProblem = null;
            testPassed = false;
            testAccuracy = 0;
        }

        // Initialize Pyodide
        async function initPyodide() {
            const statusEl = document.getElementById('pyodide-status');
            statusEl.textContent = 'Loading Python environment...';
            
            try {
                pyodide = await loadPyodide();
                statusEl.textContent = 'Python environment ready';
                statusEl.className = 'pyodide-status status-ready';
                console.log('Pyodide Loaded');
            } catch (error) {
                statusEl.textContent = 'Load Failed';
                statusEl.style.background = '#f44336';
                console.error('Pyodide Load Failed:', error);
                alert('Python environment failed to load. Please refresh the page.');
            }
        }

        // Run Code
        async function runCodeWithTimeout(code, testCase) {
            return new Promise(async (resolve, reject) => {
                let timeoutId;
                let cancelled = false;

                timeoutId = setTimeout(() => {
                    cancelled = true;
                    reject(new Error(`Runtime Timeout (>${TIMEOUT_LIMIT/1000}s)`));
                }, TIMEOUT_LIMIT);

                try {
                    const inputData = testCase.input ? testCase.input.split('\n') : [];
                    let inputIndex = 0;
                    
                    pyodide.globals.set('input', () => {
                        if (cancelled) throw new Error('Execution cancelled due to timeout');
                        if (inputIndex < inputData.length) {
                            return inputData[inputIndex++];
                        }
                        throw new Error('No more input available');
                    });
                    
                    let output = '';
                    pyodide.globals.set('print', (...args) => {
                        if (cancelled) throw new Error('Execution cancelled due to timeout');
                        output += args.join(' ') + '\n';
                    });
                    
                    await pyodide.runPythonAsync(code);
                    
                    clearTimeout(timeoutId);
                    
                    if (!cancelled) {
                        resolve(output.trim());
                    }
                } catch (error) {
                    clearTimeout(timeoutId);
                    if (cancelled) {
                        reject(new Error(`Runtime Timeout (>${TIMEOUT_LIMIT/1000}s)`));
                    } else {
                        reject(error);
                    }
                }
            });
        }

        // Run Tests
        async function runCode() {
            if (isRunning) {
                alert('Program is currently running, please wait...');
                return;
            }

            if (!pyodide) {
                alert('Python environment has not finished loading, please wait...');
                return;
            }

            if (!currentProblem) {
                alert('Please select a problem first!');
                return;
            }

            const code = document.getElementById('code-editor').value;
            const outputEl = document.getElementById('output');
            const runBtn = document.getElementById('run-btn');
            const progressBar = document.getElementById('progress-bar');
            const progressFill = document.getElementById('progress-fill');
            
            if (!code.trim()) {
                outputEl.innerHTML = '<span class="error">Please enter your code!</span>';
                return;
            }

            isRunning = true;
            runBtn.disabled = true;
            runBtn.textContent = 'Running...';
            progressBar.style.display = 'block';
            
            outputEl.textContent = 'Running...';
            
            const allTestCases = [
                ...currentProblem.publicTestCases,
                ...currentProblem.hiddenTestCases
            ];
            
            let allPassed = true;
            let results = [];
            let publicPassed = 0;
            let publicTotal = currentProblem.publicTestCases.length;
            let hiddenPassed = 0;
            let hiddenTotal = currentProblem.hiddenTestCases.length;
            let totalPassed = 0;
            let totalTests = allTestCases.length;

            try {
                for (let i = 0; i < allTestCases.length; i++) {
                    const testCase = allTestCases[i];
                    const isHidden = i >= currentProblem.publicTestCases.length;
                    
                    progressFill.style.width = `${((i + 1) / allTestCases.length) * 100}%`;
                    
                    try {
                        const actualOutput = await runCodeWithTimeout(code, testCase);
                        const passed = actualOutput === testCase.expected;
                        
                        results.push({
                            testNum: isHidden ? i - currentProblem.publicTestCases.length + 1 : i + 1,
                            input: testCase.input || '(no input)',
                            expected: testCase.expected,
                            actual: actualOutput,
                            passed: passed,
                            isHidden: isHidden,
                            error: null
                        });
                        
                        if (passed) {
                            totalPassed++;
                            if (isHidden) hiddenPassed++;
                            else publicPassed++;
                        } else {
                            allPassed = false;
                        }
                    } catch (error) {
                        results.push({
                            testNum: isHidden ? i - currentProblem.publicTestCases.length + 1 : i + 1,
                            input: testCase.input || '(no input)',
                            expected: testCase.expected,
                            actual: '',
                            passed: false,
                            isHidden: isHidden,
                            error: error.message
                        });
                        allPassed = false;
                    }
                }
                
                // Calculate Accuracy
                testAccuracy = Math.round((totalPassed / totalTests) * 100);
                
                let resultHtml = '';
                resultHtml += `Test Results Summary:\n`;
                resultHtml += `Public Test Cases: ${publicPassed}/${publicTotal} passed\n`;
                if (hiddenTotal > 0) {
                    resultHtml += `Hidden Test Cases: ${hiddenPassed}/${hiddenTotal} passed\n`;
                }
                resultHtml += `Overall Accuracy: ${testAccuracy}%\n`;
                resultHtml += `\n`;
                
                resultHtml += `Public Test Case Results:\n`;
                results.filter(r => !r.isHidden).forEach(result => {
                    if (result.error) {
                        resultHtml += `Test Case ${result.testNum}: <span class="error">Runtime Error</span>\n`;
                        resultHtml += `  Error Message: ${result.error}\n`;
                    } else {
                        const status = result.passed ? 
                            '<span class="success">‚úìPassed</span>' : 
                            '<span class="error">Failed</span>';
                        resultHtml += `Test Case ${result.testNum}: ${status}\n`;
                        if (result.input !== '(no input)') {
                            resultHtml += `  Input: ${result.input.replace(/\n/g, ', ')}\n`;
                        }
                        resultHtml += `  Expected Output: ${result.expected}\n`;
                        resultHtml += `  Actual Output: ${result.actual}\n`;
                    }
                    resultHtml += `\n`;
                });
                
                if (hiddenTotal > 0) {
                    resultHtml += `\nHidden Test Case Results:\n`;
                    results.filter(r => r.isHidden).forEach(result => {
                        if (result.error) {
                            resultHtml += `Hidden Test ${result.testNum}: <span class="error">Runtime Error</span>\n`;
                        } else {
                            const status = result.passed ? 
                                '<span class="success">Passed</span>' : 
                                '<span class="error">Failed</span>';
                            resultHtml += `Hidden Test ${result.testNum}: ${status}\n`;
                        }
                    });
                }
                
                if (allPassed) {
                    resultHtml = '<span class="success">Congratulations! All test cases passed!</span>\n\n' + resultHtml;
                    testPassed = true;
                } else {
                    resultHtml = '<span class="warning">Some test cases failed</span>\n\n' + resultHtml;
                    testPassed = false;
                }
                
                outputEl.innerHTML = resultHtml;
                
            } catch (error) {
                outputEl.innerHTML = `<span class="error">Runtime Error: \n${error.toString()}</span>`;
                testPassed = false;
                testAccuracy = 0;
            } finally {
                isRunning = false;
                runBtn.disabled = false;
                runBtn.textContent = 'Run Tests';
                progressBar.style.display = 'none';
                progressFill.style.width = '0%';
                updateSubmitButton();
            }
        }

        // Update Submit Button State
        function updateSubmitButton() {
            const submitBtn = document.getElementById('submit-btn');
            const name = document.getElementById('student-name').value.trim();
            const code = document.getElementById('code-editor').value.trim();
            
            if (name && currentProblem && code) {
                submitBtn.disabled = false;
                if (!testPassed) {
                    submitBtn.textContent = 'Submit Answer';
                    submitBtn.style.background = 'linear-gradient(135deg, #ff9800, #f57c00)';
                } else {
                    submitBtn.textContent = 'Submit Answer';
                    submitBtn.style.background = 'linear-gradient(135deg, #f093fb, #f5576c)';
                }
            } else {
                submitBtn.disabled = true;
                submitBtn.textContent = 'Submit Answer';
            }
        }


        async function submitCode() {
            const name = document.getElementById('student-name').value.trim();

            let code = document.getElementById('code-editor').value;
            code = code.replace(/ /g, "_");

            if (!name || !currentProblem || !code.trim()) {
                alert('Please confirm your name and enter your code');
                return;
            }

            let testResult = testPassed ? 'All tests passed' : 'Tests not executed or failed';
            let accuracyText = `${testAccuracy}%`;

            const confirmMessage = testPassed ? 
                `Your code has passed all tests (Accuracy: ${testAccuracy}%). Do you want to submit?` :
                `Your code has not passed all tests (Accuracy: ${testAccuracy}%). Do you want to submit?`;
            
            if (!confirm(confirmMessage)) {
                return;
            }

            const fields = [
                { name: ENTRY_NAME, value: name },
                { name: ENTRY_PROBLEM, value: currentProblem.title },
                { name: ENTRY_CODE, value: code },   
                { name: ENTRY_RESULT, value: testResult },
                { name: ENTRY_ACCURACY, value: accuracyText }
            ];

            const form = document.createElement('form');
            form.action = GOOGLE_FORM_ACTION;
            form.method = 'POST';
            form.target = 'google-form-iframe';

            fields.forEach(field => {
                if (field.name === ENTRY_CODE) {
                    const textarea = document.createElement('textarea');
                    textarea.name = field.name;
                    textarea.value = field.value;
                    form.appendChild(textarea);
                } else {
                    const input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = field.name;
                    input.value = field.value;
                    form.appendChild(input);
                }
            });

            let iframe = document.getElementById("google-form-iframe");
            if (!iframe) {
                iframe = document.createElement('iframe');
                iframe.style.display = 'none';
                iframe.name = 'google-form-iframe';
                iframe.id = 'google-form-iframe';
                document.body.appendChild(iframe);
            }

            document.body.appendChild(form);
            form.submit();
            document.body.removeChild(form);

            const successMessage = testPassed ? 
                `Answer submitted (Accuracy: ${testAccuracy}%)` :
                `Answer submitted (Accuracy: ${testAccuracy}%)`;
            
            alert(successMessage);
        }


        document.getElementById('student-name').addEventListener('input', updateSubmitButton);

        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape') {
                closeEditor();
            }
            if ((e.ctrlKey || e.metaKey) && e.key === 'Enter') {
                e.preventDefault();
                if (currentProblem && !isRunning) {
                    runCode();
                }
            }
        });

        window.addEventListener('load', initPyodide);

        // Prevent Accidental Page Leave
        window.addEventListener('beforeunload', function(e) {
            if (currentProblem) {
                let code = document.getElementById('code-editor').value;
                code = code.replace(/ /g, "_");
                
                if (code && code.trim() !== '' && code !== currentProblem.template) {
                    e.preventDefault();
                    e.returnValue = 'You have unsaved code, are you sure you want to leave?';
                }
            }
        });
    </script>
</body>
</html>
